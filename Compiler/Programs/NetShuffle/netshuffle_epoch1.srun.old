# Ports
PIN  pFromExternal;
PIN  pFromInternal;
POUT pToExternal;
POUT pToInternal;
# Stage 1: ToEdgeNetwork (external → internal)
PREFILTER toEdge_s1
  KEY PKT.PORT == pFromExternal;
  KEY IPV4.DST == "1.1.1.1";
  DEFAULT FWD pToInternal;
  BODY
    HASSIGN IPV4.DST "192.168.1.1";
  END
END

PREFILTER toEdge_s2
  KEY PKT.PORT == pFromExternal;
  KEY IPV4.DST == "1.1.1.2";
  DEFAULT FWD pToInternal;
  BODY
    HASSIGN IPV4.DST "192.168.1.2";
  END
END

PREFILTER toEdge_s3
  KEY PKT.PORT == pFromExternal;
  KEY IPV4.DST == "1.1.1.3";
  DEFAULT FWD pToInternal;
  BODY
    HASSIGN IPV4.DST "192.168.1.3";
  END
END

PREFILTER toEdge_proxy
  KEY PKT.PORT == pFromExternal;
  KEY IPV4.DST == "1.1.1.4";
  DEFAULT FWD pToInternal;
  BODY
    HASSIGN IPV4.DST "192.168.1.4";
  END
END

# Stage 2: FromEdgeNetwork (internal → external)
PREFILTER fromEdge_s1
  KEY PKT.PORT == pFromInternal;
  KEY IPV4.SRC == "192.168.1.1";
  DEFAULT FWD pToExternal;
  BODY
    HASSIGN IPV4.SRC "1.1.1.1";
  END
END

PREFILTER fromEdge_s2
  KEY PKT.PORT == pFromInternal;
  KEY IPV4.SRC == "192.168.1.2";
  DEFAULT FWD pToExternal;
  BODY
    HASSIGN IPV4.SRC "1.1.1.2";
  END
END

PREFILTER fromEdge_s3
  KEY PKT.PORT == pFromInternal;
  KEY IPV4.SRC == "192.168.1.3";
  DEFAULT FWD pToExternal;
  BODY
    HASSIGN IPV4.SRC "1.1.1.3";
  END
END

PREFILTER fromEdge_proxy
  KEY PKT.PORT == pFromInternal;
  KEY IPV4.SRC == "192.168.1.4";
  DEFAULT FWD pToExternal;
  BODY
    HASSIGN IPV4.SRC "1.1.1.4";
  END
END
